<?php
$plugins = $this->getHelperPluginManager();

$searchingForm = $plugins->has('searchingForm') ? $plugins->get('searchingForm') : null;

// Safe access to ThemeFunctions helper with fallback shim
$themeFunctionsLocal = null;
if ($plugins) {
    if ($plugins->has('themeFunctions')) {
        $themeFunctionsLocal = $plugins->get('themeFunctions');
    } elseif ($plugins->has('ThemeFunctions')) {
        $themeFunctionsLocal = $plugins->get('ThemeFunctions');
    }
}
if (!$themeFunctionsLocal) {
    $themeFunctionsLocal = new class {
        public function getFontFamily($fontKey) {
            $fontMap = [
                'helvetica' => 'Helvetica Neue, Arial, sans-serif',
                'roboto' => 'Roboto, Arial, sans-serif',
                'open_sans' => 'Open Sans, Arial, sans-serif',
                'lato' => 'Lato, Arial, sans-serif',
                'montserrat' => 'Montserrat, Arial, sans-serif',
                'source_sans' => 'Source Sans Pro, Arial, sans-serif',
                'nunito' => 'Nunito, Arial, sans-serif',
                'poppins' => 'Poppins, Arial, sans-serif',
                'inter' => 'Inter, Arial, sans-serif',
                'work_sans' => 'Work Sans, Arial, sans-serif',
                'fira_sans' => 'Fira Sans, Arial, sans-serif',
                'verdana' => 'Verdana, Arial, sans-serif',
                'arial' => 'Arial, sans-serif',
                'merriweather' => 'Merriweather, Georgia, serif',
                'playfair' => 'Playfair Display, Georgia, serif',
                'crimson' => 'Crimson Text, Georgia, serif',
                'libre_baskerville' => 'Libre Baskerville, Georgia, serif',
                'lora' => 'Lora, Georgia, serif',
                'pt_serif' => 'PT Serif, Georgia, serif',
                'source_serif' => 'Source Serif Pro, Georgia, serif',
                'georgia' => 'Georgia, serif',
                'times' => 'Times New Roman, serif',
                'oswald' => 'Oswald, Arial, sans-serif',
                'raleway' => 'Raleway, Arial, sans-serif',
                'bebas_neue' => 'Bebas Neue, Arial, sans-serif',
                'anton' => 'Anton, Arial, sans-serif',
                'dancing_script' => 'Dancing Script, cursive',
                'pacifico' => 'Pacifico, cursive',
                'fira_code' => 'Fira Code, Consolas, monospace',
                'source_code' => 'Source Code Pro, Consolas, monospace',
                'courier' => 'Courier New, monospace',
                'system' => 'system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',
            ];
            return $fontMap[$fontKey] ?? $fontMap['system'];
        }
    };
}
?>

<div class="top-bar">
    <nav class="top-bar-left" aria-label="<?php echo $this->translate('Mobile navigation'); ?>">
        <div class="title-bar" data-responsive-toggle="responsive-menu" data-hide-for="large">
            <button class="menu-toggle" type="button" data-toggle="offCanvas" aria-label="<?php echo $this->translate('Menu'); ?>"><i class="fas fa-bars"></i></button>
        </div>
        <?php
        // Get enhanced logo and branding settings
        $siteLogo = $this->themeSettingAssetUrl('site_logo');
        $logoLinkPage = $this->themeSetting('logo_link_page', '/');
        $siteTagline = $this->themeSetting('site_tagline', '');
        $headerLayout = $this->themeSetting('header_layout', 'title_only');

        // Get configurable sizing settings
        $logoHeight = $this->themeSetting('logo_height', '80');
        $taglineFontSize = $this->themeSetting('tagline_font_size', '0.9');
        $headerHeight = $this->themeSetting('header_height', '100');
        ?>

        <div class="centered-header-content" style="text-align: center; padding: 20px 0; min-height: <?php echo (int) $headerHeight; ?>px;">
            <?php if ($siteLogo): ?>
                <div class="logo-container" style="margin-bottom: 30px; padding-bottom: 15px;">
                    <a href="<?php echo $this->escapeHtml($logoLinkPage); ?>" style="text-decoration: none;">
                        <img src="<?php echo $siteLogo; ?>"
                             alt="<?php echo $this->escapeHtml($site->title()); ?> Logo"
                             class="site-logo centered-logo"
                             style="max-height: <?php echo (int) $logoHeight; ?>px; width: auto; display: block; margin: 0 auto 25px auto; padding-bottom: 10px;">
                    </a>
                </div>
            <?php endif; ?>

            <?php /* Tagline is rendered centrally in layout header to avoid duplicates. */ ?>
        </div>
    </nav>
    <!-- Navigation menu removed from header - now only in off-canvas mobile menu -->
</div>
