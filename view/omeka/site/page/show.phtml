<?php
$this->headLink()->prependStylesheet($this->assetUrl('css/page-blocks.css', 'Omeka'));
$this->htmlElement('body')->appendAttribute('class', 'page ' . $page->slug() . ' sufism-page-style sufism-reoriented-page');
$this->pageTitle($page->title(), 2);
$showPagePagination = $this->siteSetting('show_page_pagination', true);

// Add Sufism Reoriented styling for pages
$this->headLink()->appendStylesheet($this->assetUrl('css/library.css'));

// Force load the JavaScript for hamburger menu
$this->headScript()->appendFile($this->assetUrl('js/sufism-menu.js'));

// Add inline CSS to ensure styles are applied
$this->headStyle()->appendStyle('
/* FORCE SUFISM REORIENTED STYLES */
.page-title-top {
    font-family: "Cormorant Garamond", serif !important;
    font-size: 112px !important;
    color: #b37c05 !important;
    text-align: center !important;
    margin: 40px 0 60px 0 !important;
    font-weight: 400 !important;
    line-height: 1.2 !important;
}

.top-level-menu-toggle {
    margin: 40px 0 !important;
    position: relative !important;
}

.hamburger-menu-btn {
    display: flex !important;
    align-items: center !important;
    gap: 16px !important;
    background: transparent !important;
    border: 2px solid #b37c05 !important;
    padding: 24px 40px !important;
    color: #b37c05 !important;
    font-family: Arial, sans-serif !important;
    font-size: 22px !important;
    text-transform: uppercase !important;
    letter-spacing: 2px !important;
    cursor: pointer !important;
    transition: all 0.3s ease !important;
    width: 100% !important;
    justify-content: center !important;
}

.omeka-pagination .button {
    padding: 24px 40px !important;
    font-size: 22px !important;
    font-family: Arial, sans-serif !important;
    text-transform: uppercase !important;
    letter-spacing: 2px !important;
    border: 2px solid var(--library-secondary-color, #005599) !important;
    background: transparent !important;
    color: var(--library-secondary-color, #005599) !important;
    text-decoration: none !important;
    transition: all 0.3s ease !important;
}
');
?>

<?php
$nav = $site->publicNav();
$container = $nav->getContainer();
$activePage = $nav->findActive($container);
if ($activePage):
?>
    <?php if ($activePage['depth'] !== 0): ?>
    <nav class="breadcrumbs"><?php echo $nav->breadcrumbs()->setPartial('common/foundation-breadcrumbs'); ?></nav>
    <?php endif; ?>
<?php endif; ?>

<?php if ($activePage): ?>
    <?php if ($this->displayNavigation && $activePage['page']->hasPages()): ?>
    <nav class="sub-menu wide" data-sticky-container>
        <div class="sticky" data-sticky data-anchor="blocks">
            <?php echo $nav->menu()->setUlClass('vertical menu')->renderSubMenu(); ?>
        </div>
    </nav>
    <?php endif; ?>
<?php endif; ?>

<?php $this->trigger('view.show.before'); ?>

<!-- Sufism Reoriented Page Structure -->
<div class="main-content">
    <div class="content-section">
        <!-- PAGE TITLE AT THE TOP -->
        <h1 class="page-title-top"><?php echo $this->escapeHtml($page->title()); ?></h1>

        <div class="section-content">
            <div id="blocks" class="blocks">
                <?php echo $this->content; ?>
            </div>
        </div>
    </div>
</div>

<?php $this->trigger('view.show.after'); ?>
<?php if ($showPagePagination): ?>
<?php echo $this->sitePagePagination(); ?>
<?php endif; ?>
